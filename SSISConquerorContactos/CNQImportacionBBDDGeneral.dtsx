<?xml version="1.0"?>
<DTS:Executable xmlns:DTS="www.microsoft.com/SqlServer/Dts"
  DTS:refId="Package"
  DTS:CreationDate="8/14/2015 12:32:34 AM"
  DTS:CreationName="Microsoft.Package"
  DTS:CreatorComputerName="PRT0150"
  DTS:CreatorName="TSOFICINA\iñigo.mingo"
  DTS:DTSID="{0A2B1E57-D636-4943-98C2-E99BD2A27BCC}"
  DTS:ExecutableType="Microsoft.Package"
  DTS:LastModifiedProductVersion="12.0.2430.0"
  DTS:LocaleID="3082"
  DTS:ObjectName="CNQImportacionBBDDGeneral"
  DTS:PackageType="5"
  DTS:VersionBuild="21"
  DTS:VersionGUID="{85FF309B-85CF-46F8-AC5C-E505525749C4}">
  <DTS:Property
    DTS:Name="PackageFormatVersion">8</DTS:Property>
  <DTS:ConnectionManagers>
    <DTS:ConnectionManager
      DTS:refId="Package.ConnectionManagers[Administrador de conexiones con Excel]"
      DTS:CreationName="EXCEL"
      DTS:DTSID="{2D6683DC-B69F-42B8-8BD7-790718D7F2E6}"
      DTS:ObjectName="Administrador de conexiones con Excel">
      <DTS:ObjectData>
        <DTS:ConnectionManager
          DTS:ConnectionString="Provider=Microsoft.ACE.OLEDB.12.0;Data Source=D:\Dropbox\Dropbox\Conqueror\FicherosCarga\BBDDGeneral\BBDD_General_21Agosto2015.xlsx;Extended Properties=&quot;Excel 12.0 XML;HDR=YES&quot;;" />
      </DTS:ObjectData>
    </DTS:ConnectionManager>
  </DTS:ConnectionManagers>
  <DTS:Variables>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{5903AD3D-172C-49DE-914E-DF77B103C114}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="FicheroBBDDGeneral">
      <DTS:VariableValue
        DTS:DataType="8"
        xml:space="preserve"></DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{98E96DAD-5724-4741-9418-AE5A92921434}"
      DTS:IncludeInDebugDump="6789"
      DTS:Namespace="User"
      DTS:ObjectName="IdFichero">
      <DTS:VariableValue
        DTS:DataType="3">0</DTS:VariableValue>
    </DTS:Variable>
  </DTS:Variables>
  <DTS:Executables>
    <DTS:Executable
      DTS:refId="Package\Bucle BBDD General"
      DTS:CreationName="STOCK:FOREACHLOOP"
      DTS:Description="Contenedor de bucles Foreach"
      DTS:DTSID="{1C7AD099-3794-4F0C-B993-2B661A79D0F4}"
      DTS:ExecutableType="STOCK:FOREACHLOOP"
      DTS:LocaleID="-1"
      DTS:ObjectName="Bucle BBDD General">
      <DTS:ForEachEnumerator
        DTS:CreationName="Microsoft.ForEachFileEnumerator"
        DTS:DTSID="{FBF43B3B-6CB1-43A3-8A7C-5F7E09940960}"
        DTS:ObjectName="{FBF43B3B-6CB1-43A3-8A7C-5F7E09940960}">
        <DTS:PropertyExpression
          DTS:Name="Directory">@[$Project::PathBBDDGeneral]</DTS:PropertyExpression>
        <DTS:ObjectData>
          <ForEachFileEnumeratorProperties>
            <FEFEProperty
              Folder="D:\Dropbox\Dropbox\Conqueror\FicherosCarga\BBDDGeneral\" />
            <FEFEProperty
              FileSpec="*.xlsx" />
            <FEFEProperty
              FileNameRetrievalType="1" />
            <FEFEProperty
              Recurse="0" />
          </ForEachFileEnumeratorProperties>
        </DTS:ObjectData>
      </DTS:ForEachEnumerator>
      <DTS:Variables />
      <DTS:Executables>
        <DTS:Executable
          DTS:refId="Package\Bucle BBDD General\Carga BBDD General"
          DTS:CreationName="Microsoft.Pipeline"
          DTS:Description="Tarea Flujo de datos"
          DTS:DTSID="{28F34DBF-F2D2-43A1-A3B0-14D694130A65}"
          DTS:ExecutableType="Microsoft.Pipeline"
          DTS:LocaleID="-1"
          DTS:ObjectName="Carga BBDD General"
          DTS:TaskContact="Performs high-performance data extraction, transformation and loading;Microsoft Corporation; Microsoft SQL Server; (C) Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
          <DTS:Variables />
          <DTS:ObjectData>
            <pipeline
              version="1">
              <components>
                <component
                  refId="Package\Bucle BBDD General\Carga BBDD General\Origen de ADO NET"
                  componentClassID="Microsoft.ManagedComponentHost"
                  contactInfo="Consume datos de SQL Server, OLE DB, ODBC u Oracle mediante el correspondiente proveedor de datos de .NET Framework. Se usa una instrucción Transact-SQL para definir el conjunto de resultados. Por ejemplo, se extraen datos de SQL Server con el proveedor de datos de .NET Framework para SQL Server.;Microsoft Corporation; Microsoft SQL Server; © Microsoft Corporation; Todos los derechos reservados; http://www.microsoft.com/sql/support;4"
                  description="Consume datos de SQL Server, OLE DB, ODBC u Oracle mediante el correspondiente proveedor de datos de .NET Framework. Se usa una instrucción Transact-SQL para definir el conjunto de resultados. Por ejemplo, se extraen datos de SQL Server con el proveedor de datos de .NET Framework para SQL Server."
                  name="Origen de ADO NET"
                  usesDispositions="true"
                  version="4">
                  <properties>
                    <property
                      dataType="System.String"
                      description="Especifica la instrucción SQL utilizada por el componente para extraer datos."
                      expressionType="Notify"
                      name="SqlCommand"
                      UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor"></property>
                    <property
                      dataType="System.Int32"
                      description="Número de segundos antes de que se agote el tiempo de espera de un comando. Un valor de 0 indica un tiempo de espera infinito."
                      name="CommandTimeout">30</property>
                    <property
                      dataType="System.Boolean"
                      description="Indica si se debe permitir que columnas externas que no sean de cadenas se conviertan implícitamente en cadenas en las columnas de salida."
                      name="AllowImplicitStringConversion">true</property>
                    <property
                      dataType="System.String"
                      description="Nombre de la tabla de la base de datos de origen."
                      expressionType="Notify"
                      name="TableOrViewName"
                      UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor"></property>
                    <property
                      dataType="System.Int32"
                      description="Especificar el modo de recuperar información de columnas externas"
                      name="AccessMode"
                      typeConverter="Microsoft.SqlServer.Dts.Pipeline.DataReaderSourceAdapter+EnumToStringConverter">2</property>
                    <property
                      dataType="System.String"
                      name="UserComponentTypeName">Microsoft.DataReaderSourceAdapter</property>
                  </properties>
                  <connections>
                    <connection
                      refId="Package\Bucle BBDD General\Carga BBDD General\Origen de ADO NET.Connections[IDbConnection]"
                      description="Administrador de conexiones administrado"
                      name="IDbConnection" />
                  </connections>
                  <outputs>
                    <output
                      refId="Package\Bucle BBDD General\Carga BBDD General\Origen de ADO NET.Outputs[Salida de origen de ADO NET]"
                      name="Salida de origen de ADO NET">
                      <externalMetadataColumns
                        isUsed="True" />
                    </output>
                    <output
                      refId="Package\Bucle BBDD General\Carga BBDD General\Origen de ADO NET.Outputs[Salida de error de origen de ADO NET]"
                      isErrorOut="true"
                      name="Salida de error de origen de ADO NET">
                      <outputColumns>
                        <outputColumn
                          refId="Package\Bucle BBDD General\Carga BBDD General\Origen de ADO NET.Outputs[Salida de error de origen de ADO NET].Columns[ErrorCode]"
                          dataType="i4"
                          lineageId="Package\Bucle BBDD General\Carga BBDD General\Origen de ADO NET.Outputs[Salida de error de origen de ADO NET].Columns[ErrorCode]"
                          name="ErrorCode"
                          specialFlags="1" />
                        <outputColumn
                          refId="Package\Bucle BBDD General\Carga BBDD General\Origen de ADO NET.Outputs[Salida de error de origen de ADO NET].Columns[ErrorColumn]"
                          dataType="i4"
                          lineageId="Package\Bucle BBDD General\Carga BBDD General\Origen de ADO NET.Outputs[Salida de error de origen de ADO NET].Columns[ErrorColumn]"
                          name="ErrorColumn"
                          specialFlags="2" />
                      </outputColumns>
                      <externalMetadataColumns />
                    </output>
                  </outputs>
                </component>
                <component
                  refId="Package\Bucle BBDD General\Carga BBDD General\Origen de OLE DB"
                  componentClassID="Microsoft.OLEDBSource"
                  contactInfo="Origen de OLE DB;Microsoft Corporation; Microsoft SQL Server; (C) Microsoft Corporation; Todos los derechos reservados; http://www.microsoft.com/sql/support;7"
                  description="Origen de OLE DB"
                  name="Origen de OLE DB"
                  usesDispositions="true"
                  version="7">
                  <properties>
                    <property
                      dataType="System.Int32"
                      description="Número de segundos antes de que se agote el tiempo de espera de un comando. Un valor de 0 indica un tiempo de espera infinito."
                      name="CommandTimeout">0</property>
                    <property
                      dataType="System.String"
                      description="Especifica el nombre del objeto de base de datos usado para abrir un conjunto de filas."
                      name="OpenRowset"></property>
                    <property
                      dataType="System.String"
                      description="Especifica la variable que contiene el nombre del objeto de base de datos usado para abrir un conjunto de filas."
                      name="OpenRowsetVariable"></property>
                    <property
                      dataType="System.String"
                      description="Comando SQL para ejecutar."
                      name="SqlCommand"
                      UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor"></property>
                    <property
                      dataType="System.String"
                      description="Variable que contiene el comando SQL para ejecutar."
                      name="SqlCommandVariable"></property>
                    <property
                      dataType="System.Int32"
                      description="Especifica la página de códigos de columna para utilizar cuando la información de página de códigos no está disponible en el origen de datos."
                      name="DefaultCodePage">1252</property>
                    <property
                      dataType="System.Boolean"
                      description="Fuerza el uso del valor de la propiedad DefaultCodePage al describir datos de caracteres."
                      name="AlwaysUseDefaultCodePage">false</property>
                    <property
                      dataType="System.Int32"
                      description="Especifica el modo utilizado para obtener acceso a la base de datos."
                      name="AccessMode"
                      typeConverter="AccessMode">0</property>
                    <property
                      dataType="System.String"
                      description="Asignaciones entre los parámetros del comando SQL y las variables."
                      name="ParameterMapping"></property>
                  </properties>
                  <connections>
                    <connection
                      refId="Package\Bucle BBDD General\Carga BBDD General\Origen de OLE DB.Connections[OleDbConnection]"
                      description="La conexión de tiempo de ejecución OLE DB usada para obtener acceso a la base de datos."
                      name="OleDbConnection" />
                  </connections>
                  <outputs>
                    <output
                      refId="Package\Bucle BBDD General\Carga BBDD General\Origen de OLE DB.Outputs[Salida de origen de OLE DB]"
                      name="Salida de origen de OLE DB">
                      <externalMetadataColumns
                        isUsed="True" />
                    </output>
                    <output
                      refId="Package\Bucle BBDD General\Carga BBDD General\Origen de OLE DB.Outputs[Salida de error de origen de OLE DB]"
                      isErrorOut="true"
                      name="Salida de error de origen de OLE DB">
                      <outputColumns>
                        <outputColumn
                          refId="Package\Bucle BBDD General\Carga BBDD General\Origen de OLE DB.Outputs[Salida de error de origen de OLE DB].Columns[ErrorCode]"
                          dataType="i4"
                          lineageId="Package\Bucle BBDD General\Carga BBDD General\Origen de OLE DB.Outputs[Salida de error de origen de OLE DB].Columns[ErrorCode]"
                          name="ErrorCode"
                          specialFlags="1" />
                        <outputColumn
                          refId="Package\Bucle BBDD General\Carga BBDD General\Origen de OLE DB.Outputs[Salida de error de origen de OLE DB].Columns[ErrorColumn]"
                          dataType="i4"
                          lineageId="Package\Bucle BBDD General\Carga BBDD General\Origen de OLE DB.Outputs[Salida de error de origen de OLE DB].Columns[ErrorColumn]"
                          name="ErrorColumn"
                          specialFlags="2" />
                      </outputColumns>
                      <externalMetadataColumns />
                    </output>
                  </outputs>
                </component>
              </components>
            </pipeline>
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\Bucle BBDD General\Log Fin de Carga"
          DTS:CreationName="Microsoft.ExecuteSQLTask"
          DTS:Description="Tarea Ejecutar SQL"
          DTS:DTSID="{602AFA0B-E667-4DB8-834A-609F8187CAA0}"
          DTS:ExecutableType="Microsoft.ExecuteSQLTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="Log Fin de Carga"
          DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2014; © 2014 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
          DTS:ThreadHint="0">
          <DTS:Variables />
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{11E541B9-8682-42BF-9E46-A6827FBA7CEF}"
              SQLTask:SqlStatementSource="EXEC [input].[PR_CNQ_FicheroCargaFin] @IdFichero" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="@IdFichero"
                SQLTask:DtsVariableName="User::IdFichero"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="11"
                SQLTask:ParameterSize="-1" />
            </SQLTask:SqlTaskData>
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\Bucle BBDD General\Log Inicio de Carga"
          DTS:CreationName="Microsoft.ExecuteSQLTask"
          DTS:Description="Tarea Ejecutar SQL"
          DTS:DTSID="{6E9C6724-EE87-4481-B0C4-6EBE375A3B68}"
          DTS:ExecutableType="Microsoft.ExecuteSQLTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="Log Inicio de Carga"
          DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2014; © 2014 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
          DTS:ThreadHint="0">
          <DTS:Variables />
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{11E541B9-8682-42BF-9E46-A6827FBA7CEF}"
              SQLTask:SqlStatementSource="DECLARE @IdFichero INT&#xA;&#xA;EXEC @IdFichero = [input].[PR_CNQ_FicheroCargaInicio] 1,@DsFichero&#xA;&#xA;SELECT @IdFichero as IdFichero"
              SQLTask:ResultType="ResultSetType_SingleRow" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
              <SQLTask:ResultBinding
                SQLTask:ResultName="0"
                SQLTask:DtsVariableName="User::IdFichero" />
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="@DsFichero"
                SQLTask:DtsVariableName="User::FicheroBBDDGeneral"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="16"
                SQLTask:ParameterSize="100" />
            </SQLTask:SqlTaskData>
          </DTS:ObjectData>
        </DTS:Executable>
      </DTS:Executables>
      <DTS:PrecedenceConstraints>
        <DTS:PrecedenceConstraint
          DTS:refId="Package\Bucle BBDD General.PrecedenceConstraints[Restricción]"
          DTS:CreationName=""
          DTS:DTSID="{6B271D1F-D815-4C67-8138-2FFB7D3D60B5}"
          DTS:EvalOp="3"
          DTS:Expression="@[User::IdFichero]&gt;0"
          DTS:From="Package\Bucle BBDD General\Log Inicio de Carga"
          DTS:LogicalAnd="True"
          DTS:ObjectName="Restricción"
          DTS:To="Package\Bucle BBDD General\Carga BBDD General" />
        <DTS:PrecedenceConstraint
          DTS:refId="Package\Bucle BBDD General.PrecedenceConstraints[Restricción 1]"
          DTS:CreationName=""
          DTS:DTSID="{FB4A377B-D84B-462E-AB3C-B1FB4F884E2E}"
          DTS:From="Package\Bucle BBDD General\Carga BBDD General"
          DTS:LogicalAnd="True"
          DTS:ObjectName="Restricción 1"
          DTS:To="Package\Bucle BBDD General\Log Fin de Carga" />
      </DTS:PrecedenceConstraints>
      <DTS:ForEachVariableMappings>
        <DTS:ForEachVariableMapping
          DTS:CreationName=""
          DTS:DTSID="{F67B5ED1-02DC-439D-A9FC-D77A8FFCBA82}"
          DTS:ObjectName="{F67B5ED1-02DC-439D-A9FC-D77A8FFCBA82}"
          DTS:ValueIndex="0"
          DTS:VariableName="User::FicheroBBDDGeneral" />
      </DTS:ForEachVariableMappings>
    </DTS:Executable>
  </DTS:Executables>
  <DTS:DesignTimeProperties><![CDATA[<?xml version="1.0"?>
<!--Esta sección CDATA contiene la información de diseño del paquete. Esta sección incluye información como, por ejemplo, las coordenadas (x,y), el ancho y el alto.-->
<!--Si edita manualmente esta sección y comete un error, puede eliminarlo. -->
<!--El paquete podrá cargarse normalmente, pero se perderá la información de diseño anterior y el diseñador reorganizará los elementos automáticamente en la superficie de diseño.-->
<Objects
  Version="sql12">
  <!--Cada uno de los nodos siguientes contiene propiedades que no afectan al comportamiento en tiempo de ejecución.-->
  <Package
    design-time-name="Package">
    <LayoutInfo>
      <GraphLayout
        Capacity="8" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:mssgm="clr-namespace:Microsoft.SqlServer.Graph.Model;assembly=Microsoft.SqlServer.Graph">
        <NodeLayout
          Size="176,42"
          Id="Package\Bucle BBDD General\Carga BBDD General"
          TopLeft="5.50000000000003,107.5" />
        <NodeLayout
          Size="159,42"
          Id="Package\Bucle BBDD General\Log Fin de Carga"
          TopLeft="14,209.5" />
        <NodeLayout
          Size="170,42"
          Id="Package\Bucle BBDD General\Log Inicio de Carga"
          TopLeft="8.50000000000001,5.5" />
        <EdgeLayout
          Id="Package\Bucle BBDD General.PrecedenceConstraints[Restricción]"
          TopLeft="93.5,47.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,60"
              Start="0,0"
              End="0,52.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,52.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <mssgm:EdgeLabel
              BoundingBox="-8,18.25,16,16"
              RelativePosition="Any" />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Bucle BBDD General.PrecedenceConstraints[Restricción 1]"
          TopLeft="93.5,149.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,60"
              Start="0,0"
              End="0,52.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,52.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <ContainerLayout
          HeaderHeight="43"
          IsExpanded="True"
          PanelSize="187,307"
          Size="187,350"
          Id="Package\Bucle BBDD General"
          TopLeft="5.50000000000004,5.5" />
      </GraphLayout>
    </LayoutInfo>
  </Package>
  <TaskHost
    design-time-name="Package\Bucle BBDD General\Carga BBDD General">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph">
        <NodeLayout
          Size="164,42"
          Id="Package\Bucle BBDD General\Carga BBDD General\Origen de OLE DB"
          TopLeft="154,51" />
        <NodeLayout
          Size="172,42"
          Id="Package\Bucle BBDD General\Carga BBDD General\Origen de ADO NET"
          TopLeft="105,192" />
      </GraphLayout>
    </LayoutInfo>
  </TaskHost>
</Objects>]]></DTS:DesignTimeProperties>
</DTS:Executable>